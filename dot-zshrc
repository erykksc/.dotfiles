#!/usr/bin/env zsh
eval "$(starship init zsh)"

# Compilation flags
# export ARCHFLAGS="-arch x86_64"


# Load secrets
[ -f ~/.secrets ] && source ~/.secrets

alias bh='bat --language=help --style=plain'

alias v='nvim'
alias vc='nvim .'

alias y='yazi'
alias sgpt='python3 -m sgpt'
alias s='~/.dotfiles/scripts/tmux-client.sh'

# GIT ALIASES
alias gs='git status'
alias gc='git commit'
alias gdv='git diff | vim'
alias gl='git log'
alias ga='git add'
alias gaa='git add .'
alias gd='git diff'

alias l='eza --git'

# KEYBINDINGS
bindkey -e

# HISTORY
HISTSIZE=5000
HISTFILE=~/.zsh_history
SAVEHIST=$HISTSIZE
HISTDUP=erase
setopt appendhistory
setopt sharehistory
setopt hist_ignore_space
setopt hist_ignore_all_dups

setopt EXTENDED_GLOB

# FZF
# Set up fzf key bindings and fuzzy completion
source <(fzf --zsh)
# Setting fd as the default source for fzf
export FZF_DEFAULT_COMMAND='fd --type f --hidden --strip-cwd-prefix'
export FZF_CTRL_T_COMMAND='fd --type f --hidden --strip-cwd-prefix'
export FZF_CTRL_T_OPTS="--bind 'ctrl-d:reload(fd --type d --hidden --strip-cwd-prefix),ctrl-f:reload(eval $FZF_CTRL_T_COMMAND)'"
export FZF_ALT_C_COMMAND="fd --type d --hidden ."

# Enable completions
fpath=(
    /opt/homebrew/share/zsh/site-functions
    /usr/share/zsh/site-functions
    /usr/local/share/zsh/site-functions
    $fpath
)
autoload -Uz compinit
compinit

# Add keybind to edit prompt in the editor
autoload -z edit-command-line
zle -N edit-command-line
bindkey "^X^E" edit-command-line

eval "$(direnv hook zsh)"

# PLUGINS
ZPLUGINDIR=${XDG_DATA_HOME:-$HOME/.local/share}/zsh-plugins
mkdir -p $ZPLUGINDIR

# zsh-autosuggestions
if [[ ! -d $ZPLUGINDIR/zsh-autosuggestions ]]; then
  git clone https://github.com/zsh-users/zsh-autosuggestions \
            $ZPLUGINDIR/zsh-autosuggestions
fi
source $ZPLUGINDIR/zsh-autosuggestions/zsh-autosuggestions.plugin.zsh

# zsh-syntax-highlighting
if [[ ! -d $ZPLUGINDIR/zsh-syntax-highlighting ]]; then
  git clone https://github.com/zsh-users/zsh-syntax-highlighting \
            $ZPLUGINDIR/zsh-syntax-highlighting
fi
source $ZPLUGINDIR/zsh-syntax-highlighting/zsh-syntax-highlighting.plugin.zsh
